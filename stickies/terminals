#!/bin/bash
# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –æ–∫–æ–Ω —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –≤ Stickies

# –°–æ–±–∏—Ä–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤
osascript -e '
tell application "Terminal"
    set windowList to "üñ• –¢–ï–†–ú–ò–ù–ê–õ–´:" & return & return
    set idx to 1
    repeat with w in (every window)
        try
            set winName to name of w
            if length of winName > 50 then
                set winName to text 1 thru 50 of winName & "..."
            end if
            set windowList to windowList & idx & ". " & winName & return
            set idx to idx + 1
            if idx > 30 then exit repeat
        end try
    end repeat
    if idx > 30 then set windowList to windowList & "... –∏ –µ—â—ë " & ((count of windows) - 30) & " –æ–∫–æ–Ω"
    return windowList
end tell
' | pbcopy

# –û—Ç–∫—Ä—ã–≤–∞–µ–º Stickies –∏ –≤—Å—Ç–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ –º–µ–Ω—é
osascript <<'EOF'
tell application "Stickies" to quit
delay 0.5
tell application "Stickies" to activate
delay 0.5

tell application "System Events"
    tell process "Stickies"
        set frontmost to true
        delay 0.3
        -- –ù–æ–≤–∞—è –∑–∞–ø–∏—Å–∫–∞
        click menu item "–ù–æ–≤–∞—è –∑–∞–º–µ—Ç–∫–∞" of menu "–§–∞–π–ª" of menu bar 1
        delay 0.3
        -- –í—Å—Ç–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ –º–µ–Ω—é (–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å–∫–ª–∞–¥–∫–∏)
        click menu item "–í—Å—Ç–∞–≤–∏—Ç—å" of menu "–ü—Ä–∞–≤–∫–∞" of menu bar 1
    end tell
end tell
EOF

echo "‚úÖ –°–ø–∏—Å–æ–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤ –≤ Stickies"
